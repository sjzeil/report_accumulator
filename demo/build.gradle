/*
 * Report Accumulator demo
 * Steven J Zeil, Old Dominion Univ.
 */


buildscript {
	repositories {
		jcenter()
		
		flatDir {
			dirs rootProject.file('../report_accumulator/build/libs')
		}
	}
	dependencies {
		classpath name: 'report_accumulator-1.2'
		classpath 'org.hidetake:gradle-ssh-plugin:2.7.0+'
	}
}

apply plugin: 'org.hidetake.ssh'


import edu.odu.cs.zeil.report_accumulator.ReportStats
import edu.odu.cs.zeil.report_accumulator.ReportsDeploy


task build (type: GradleBuild) {
	buildFile = '../report_accumulator/build.gradle'
	tasks = ['reports']
}



task reports (type: Copy, dependsOn: 'build') {
	from '../report_accumulator/build/reports'
	into 'build/reports'
}



task reportStats (type: ReportStats, dependsOn: 'reports') {
    reportsURL = 'http://www.cs.odu.edu/~zeil/gitlab/reportAccumulator/reports'
}

task deployReports (type: ReportsDeploy, dependsOn: 'reportStats') {
	//deployDestination = '/home/zeil/temp'
    //deployDestination = 'ssh://zeil@atria.cs.odu.edu:/home/zeil/temp/'
	//deployDestination = 'ssh://zeil@atria.cs.odu.edu:/home/zeil/public_html/gitlab/'
	//deployDestination = 'rsync://zeil@atria.cs.odu.edu:/home/zeil/temp/tmp'
	deployDestination = 'rsync://zeil@atria.cs.odu.edu:reportAccumulator/reports/'
}
